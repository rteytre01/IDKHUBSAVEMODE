-- ===== Config =====
_G.targetPickaxes = _G.targetPickaxes or {
    "Arcane Pickaxe",
    "Magma Pickaxe",
    "Demonic Pickaxe"
}

-- à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹€à¸ªà¸£à¹‡à¸ˆ: à¸•à¹‰à¸­à¸‡à¸¡à¸µ Demonic Pickaxe + à¹€à¸‡à¸´à¸™ 500000
_G.completionPickaxe = _G.completionPickaxe or "Demonic Pickaxe"
_G.completionGold = _G.completionGold or 500000
_G.maxLevel = _G.maxLevel or 120

-- ===== Wait Game + Horst =====
repeat task.wait(5) until game:IsLoaded()
repeat task.wait(.1) until _G.Horst_SetDescription and _G.Horst_AccountChangeDone

-- ===== Services =====
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local plr = Players.LocalPlayer

local Shared = ReplicatedStorage:WaitForChild("Shared")
local Equipments = require(ReplicatedStorage.Shared.Data.Equipments)

local Knit = require(Shared.Packages.Knit)
local PlayerController = Knit.GetController("PlayerController")
local Replica = PlayerController.Replica

-- ===== Wait for Data =====
print("â³ Waiting for Replica.Data...")
repeat task.wait(0.5) until Replica.Data and Replica.Data.Inventory and Replica.Data.Inventory.Equipments
print("âœ… Replica.Data loaded!")

-- ===== Helper Functions =====
local function hasPickaxe(pickaxeName, inventory)
    if not inventory then return false end
    for _, item in pairs(inventory) do
        if typeof(item) == "table" and item.Name == pickaxeName then
            return true
        end
    end
    return false
end

local function getRaceEmoji(race)
    local raceEmojis = {
        ["Demon"] = "ğŸ‘¿", ["Angel"] = "ğŸ‘¼ğŸ»", ["Archangel"] = "ğŸ‘¼ğŸ»ğŸ‘¿",
        ["Shadow"] = "ğŸŒ‘", ["Developer"] = "ğŸ’»", ["Golem"] = "ğŸ—¿",
        ["Orc"] = "ğŸŸ¢", ["Minotaur"] = "ğŸ‚", ["Dragonborn"] = "ğŸ‰",
        ["Dwarf"] = "â›ï¸", ["Zombie"] = "ğŸ§Ÿ", ["Orc Lord"] = "ğŸ‘‘ğŸŸ¢",
        ["Undead"] = "ğŸ’€", ["Human"] = "ğŸ‘¤", ["Elf"] = "ğŸ§", ["Goblin"] = "ğŸ‘º"
    }
    return raceEmojis[race] or "â“"
end

local function getPickaxeShort(pickaxeName)
    local shortcuts = {
        ["Arcane Pickaxe"] = "AC", ["Magma Pickaxe"] = "MM", ["Demonic Pickaxe"] = "DM"
    }
    return shortcuts[pickaxeName] or pickaxeName:sub(1, 3):upper()
end

local function formatNumber(num)
    num = math.floor(num)
    if num >= 1000000 then
        return string.format("%.1fM", num / 1000000):gsub("%.0M", "M")
    elseif num >= 1000 then
        return string.format("%.1fk", num / 1000):gsub("%.0k", "k")
    else
        return tostring(num)
    end
end

-- ===== Main Loop =====
print("â›ï¸ Starting...")
print("ğŸ¯ Target: " .. _G.completionPickaxe .. " + " .. _G.completionGold .. " Gold")
print("ğŸ“Š Max Level: " .. _G.maxLevel)

while true do
    task.wait(10)
    
    pcall(function()
        if not Replica.Data or not Replica.Data.Inventory then return end
        
        local Gold = Replica.Data.Gold or 0
        local Race = Replica.Data.Race or "None"
        local Level = Replica.Data.Level or 0
        local inventory = Replica.Data.Inventory.Equipments
        
        -- à¹€à¸Šà¹‡à¸„ Level MAX
        if Level >= _G.maxLevel then
            print("ğŸ“Š Level MAX: " .. Level)
            local msg = getRaceEmoji(Race) .. Race .. " , ğŸ“ŠLv." .. Level .. " , ğŸ’°" .. formatNumber(Gold) .. " , Level MAX"
            pcall(function() _G.Horst_SetDescription(msg) end)
            task.wait(3)
            pcall(_G.Horst_AccountChangeDone)
            return true
        end
        
        hasDemonic = false
        local pickaxeStatus = {}
        
        for _, targetName in ipairs(_G.targetPickaxes) do
            local found = hasPickaxe(targetName, inventory)
            local shortName = getPickaxeShort(targetName)
            table.insert(pickaxeStatus, (found and "âœ…" or "âŒ") .. shortName)
            if found and targetName == _G.completionPickaxe then
                hasDemonic = true
            end
        end
        
        local message = string.format(
            "%s%s , ğŸ“ŠLv.%d , ğŸ’°%s , %s",
            getRaceEmoji(Race),
            Race,
            Level,
            formatNumber(Gold),
            table.concat(pickaxeStatus, " ")
        )
        
        -- à¸ªà¸£à¹‰à¸²à¸‡ JSON à¸ªà¸³à¸«à¸£à¸±à¸š Google Sheets
        local jsonData = string.format(
            '{"RACE":"%s","Level":%s,"Gold":"%s","ArcanePickaxe":"%s","MagmaPickaxe":"%s","DemonicPickaxe":"%s"}',
            Race,
            Level,
            formatNumber(Gold),
            hasPickaxe("Arcane Pickaxe", inventory) and "âœ…" or "âŒ",
            hasPickaxe("Magma Pickaxe", inventory) and "âœ…" or "âŒ",
            hasPickaxe("Demonic Pickaxe", inventory) and "âœ…" or "âŒ"
        )
        
        print("ğŸ“¤", message)
        
        -- à¸ªà¹ˆà¸‡à¹„à¸›à¸¢à¸±à¸‡ Horst
        pcall(function()
            _G.Horst_SetDescription(message, jsonData)
        end)
        
        -- à¹€à¸Šà¹‡à¸„à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¹€à¸ªà¸£à¹‡à¸ˆ
        if hasDemonic and Gold >= _G.completionGold then
            print("ğŸ¯ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!")
            task.wait(5)
            pcall(_G.Horst_AccountChangeDone)
            return true
        end
    end)
    
    if Replica.Data and Replica.Data.Level >= _G.maxLevel then break end
    if hasDemonic and (Replica.Data.Gold or 0) >= _G.completionGold then break end
end

print("ğŸ Finished!")
