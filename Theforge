-- ===== Config =====
_G.targetPickaxes = _G.targetPickaxes or {
    "Arcane Pickaxe",
    "Magma Pickaxe",
    "Demonic Pickaxe"
}

-- à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹€à¸ªà¸£à¹‡à¸ˆ: à¸•à¹‰à¸­à¸‡à¸¡à¸µ Demonic Pickaxe + à¹€à¸‡à¸´à¸™ 500000
_G.completionPickaxe = _G.completionPickaxe or "Demonic Pickaxe"
_G.completionGold = _G.completionGold or 500000
_G.maxLevel = _G.maxLevel or 120 -- Level à¸ªà¸¹à¸‡à¸ªà¸¸à¸” à¸–à¸¶à¸‡à¹à¸¥à¹‰à¸§à¹ƒà¸«à¹‰à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸­à¸”à¸µ

-- ===== Wait Game + Horst =====
repeat task.wait(6) until game:IsLoaded()
repeat task.wait(.1) until _G.Horst_SetDescription and _G.Horst_AccountChangeDone

-- ===== Services =====
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local plr = Players.LocalPlayer

local Shared = ReplicatedStorage:WaitForChild("Shared")
local Equipments = require(ReplicatedStorage.Shared.Data.Equipments)

local Knit = require(Shared.Packages.Knit)
local PlayerController = Knit.GetController("PlayerController")
local Replica = PlayerController.Replica

-- ===== Wait for Data =====
print("â³ Waiting for Replica.Data...")
repeat task.wait(0.5) until Replica.Data and Replica.Data.Inventory and Replica.Data.Inventory.Equipments
print("âœ… Replica.Data loaded!")

-- ===== Helper Functions =====
local function hasPickaxe(pickaxeName, inventory)
    if not inventory then return false end
    for _, item in pairs(inventory) do
        if typeof(item) == "table" and item.Name == pickaxeName then
            return true
        end
    end
    return false
end

-- à¹à¸›à¸¥à¸‡ Race à¹€à¸›à¹‡à¸™ Emoji
local function getRaceEmoji(race)
    local raceEmojis = {
        ["Demon"] = "ğŸ‘¿",
        ["Angel"] = "ğŸ‘¼ğŸ»",
        ["Archangel"] = "ğŸ‘¼ğŸ»ğŸ‘¿",
        ["Shadow"] = "ğŸŒ‘",
        ["Developer"] = "ğŸ’»",
        ["Golem"] = "ğŸ—¿",
        ["Orc"] = "ğŸŸ¢",
        ["Minotaur"] = "ğŸ‚",
        ["Dragonborn"] = "ğŸ‰",
        ["Dwarf"] = "â›ï¸",
        ["Zombie"] = "ğŸ§Ÿ",
        ["Orc Lord"] = "ğŸ‘‘ğŸŸ¢",
        ["Undead"] = "ğŸ’€",
        ["Human"] = "ğŸ‘¤",
        ["Elf"] = "ğŸ§",
        ["Goblin"] = "ğŸ‘º"
    }
    return raceEmojis[race] or "â“"
end

-- à¹à¸›à¸¥à¸‡ Pickaxe à¹€à¸›à¹‡à¸™à¸•à¸±à¸§à¸¢à¹ˆà¸­
local function getPickaxeShort(pickaxeName)
    local shortcuts = {
        ["Arcane Pickaxe"] = "AC",
        ["Magma Pickaxe"] = "MM",
        ["Demonic Pickaxe"] = "DM",
        ["Diamond Pickaxe"] = "DIA",
        ["Stone Pickaxe"] = "ST",
        ["Iron Pickaxe"] = "IR",
        ["Gold Pickaxe"] = "GD"
    }
    return shortcuts[pickaxeName] or pickaxeName:sub(1, 3):upper()
end

-- à¹à¸›à¸¥à¸‡à¸•à¸±à¸§à¹€à¸¥à¸‚à¹€à¸›à¹‡à¸™ K, M
local function formatNumber(num)
    num = math.floor(num) -- à¸•à¸±à¸”à¸—à¸¨à¸™à¸´à¸¢à¸¡à¸­à¸­à¸
    
    if num >= 1000000 then
        return string.format("%.1fM", num / 1000000):gsub("%.0M", "M")
    elseif num >= 1000 then
        return string.format("%.1fk", num / 1000):gsub("%.0k", "k")
    else
        return tostring(num)
    end
end

-- ===== Main Loop =====
print("â›ï¸ Starting Pickaxe & Gold Check...")
print("ğŸ¯ Target: " .. _G.completionPickaxe .. " + " .. _G.completionGold .. " Gold")
print("ğŸ“Š Max Level: " .. _G.maxLevel)

while true do
    task.wait(10)
    
    pcall(function()
        if not Replica.Data or not Replica.Data.Inventory then
            warn("âš ï¸ Data not ready")
            return
        end
        
        local Gold = Replica.Data.Gold or 0
        local Race = Replica.Data.Race or "None"
        local Level = Replica.Data.Level or 0
        local inventory = Replica.Data.Inventory.Equipments
        
        -- à¹€à¸Šà¹‡à¸„ Level à¸–à¹‰à¸²à¸–à¸¶à¸‡ maxLevel à¹ƒà¸«à¹‰à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸­à¸”à¸µ
        if Level >= _G.maxLevel then
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("ğŸ“Š Level à¸–à¸¶à¸‡ " .. _G.maxLevel .. " à¹à¸¥à¹‰à¸§!")
            print("ğŸ”„ à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸­à¸”à¸µ...")
            
            local message = string.format(
                "%s%s , Level MAX (%d) , ğŸ’°%s",
                getRaceEmoji(Race),
                Race,
                Level,
                formatNumber(Gold)
            )
            
            pcall(function()
                _G.Horst_SetDescription(message)
            end)
            
            task.wait(3)
            
            local ok, err = pcall(_G.Horst_AccountChangeDone)
            if ok then
                print("âœ… à¸ªà¹ˆà¸‡à¸ªà¸–à¸²à¸™à¸° DONE à¸ªà¸³à¹€à¸£à¹‡à¸ˆ! (Level MAX)")
                print("ğŸ‰ à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸­à¸”à¸µ...")
            else
                warn("âŒ à¸ªà¹ˆà¸‡à¸ªà¸–à¸²à¸™à¸° DONE à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ:", err)
            end
            
            return true
        end
        
        local pickaxeStatus = {}
        local hasDemonic = false
        
        -- Check each target pickaxe
        for _, targetName in ipairs(_G.targetPickaxes) do
            local found = hasPickaxe(targetName, inventory)
            local shortName = getPickaxeShort(targetName)
            
            if found then
                table.insert(pickaxeStatus, "âœ…" .. shortName)
                if targetName == _G.completionPickaxe then
                    hasDemonic = true
                end
            else
                table.insert(pickaxeStatus, "âŒ" .. shortName)
            end
        end
        
        -- Build message: Race, Pickaxe, Level, Money
        local raceEmoji = getRaceEmoji(Race)
        local pickaxeText = table.concat(pickaxeStatus, " ")
        local goldFormatted = formatNumber(Gold)
        
        local message = string.format(
            "%s%s , %s , ğŸ“ŠLv.%d , ğŸ’°%s",
            raceEmoji,
            Race,
            pickaxeText,
            Level,
            goldFormatted
        )
        
        -- Build JSON (à¹ƒà¸Šà¹‰ âœ… â à¹à¸¥à¸°à¹à¸›à¸¥à¸‡ Gold à¹€à¸›à¹‡à¸™ K, M)
        local json_strings = {
            ArcanePickaxe = hasPickaxe("Arcane Pickaxe", inventory) and "âœ…" or "â",
            DemonicPickaxe = hasPickaxe("Demonic Pickaxe", inventory) and "âœ…" or "â",
            Gold = formatNumber(Gold), -- à¹ƒà¸Šà¹‰à¸£à¸¹à¸›à¹à¸šà¸š K, M
            GoldRaw = math.floor(Gold), -- à¹€à¸‡à¸´à¸™à¸ˆà¸£à¸´à¸‡à¹„à¸§à¹‰à¸ªà¸³à¸£à¸­à¸‡
            Level = Level,
            MagmaPickaxe = hasPickaxe("Magma Pickaxe", inventory) and "âœ…" or "â",
            RACE = Race
        }
        
        local EncodeJson = HttpService:JSONEncode(json_strings)
        
        print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
        print("ğŸ“Š Status:")
        print("  " .. raceEmoji .. Race)
        print("  ğŸ“Š Level:", Level, "/", _G.maxLevel)
        print("  ğŸ’° Gold:", goldFormatted, "(" .. math.floor(Gold) .. ")")
        for _, status in ipairs(pickaxeStatus) do
            print("  " .. status)
        end
        
        -- Send to Horst
        local sendOk, sendErr = pcall(function()
            _G.Horst_SetDescription(message, EncodeJson)
        end)
        
        if sendOk then
            print("âœ… Description sent!")
        else
            warn("âš ï¸ Failed with JSON, trying without JSON...")
            pcall(function()
                _G.Horst_SetDescription(message)
            end)
        end
        
        -- Check if done (Demonic + Gold)
        if hasDemonic and Gold >= _G.completionGold then
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("ğŸ¯ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!")
            print("  âœ… à¸¡à¸µ " .. _G.completionPickaxe)
            print("  âœ… à¹€à¸‡à¸´à¸™ " .. math.floor(Gold) .. " / " .. _G.completionGold)
            print("â³ à¸£à¸­ 5 à¸§à¸´à¸™à¸²à¸—à¸µ à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡ DONE...")
            task.wait(5)
            
            local ok, err = pcall(_G.Horst_AccountChangeDone)
            if ok then
                print("âœ… à¸ªà¹ˆà¸‡à¸ªà¸–à¸²à¸™à¸° DONE à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!")
                print("ğŸ‰ à¸šà¸±à¸à¸Šà¸µà¸™à¸µà¹‰à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œà¹à¸¥à¹‰à¸§")
            else
                warn("âŒ à¸ªà¹ˆà¸‡à¸ªà¸–à¸²à¸™à¸° DONE à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ:", err)
            end
            
            return true
        else
            if not hasDemonic then
                print("  â³ à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ " .. _G.completionPickaxe)
            end
            if Gold < _G.completionGold then
                print("  â³ à¸¢à¸±à¸‡à¸‚à¸²à¸”à¹€à¸‡à¸´à¸™ " .. formatNumber(_G.completionGold - Gold))
            end
        end
        
        print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    end)
    
    -- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š Level à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡à¸à¹ˆà¸­à¸™ loop à¸•à¹ˆà¸­
    if Replica.Data and Replica.Data.Level >= _G.maxLevel then
        break
    end
    
    if hasDemonic and (Replica.Data.Gold or 0) >= _G.completionGold then
        break
    end
end

print("ğŸ Script finished!")
