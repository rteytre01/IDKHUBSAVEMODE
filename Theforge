-- ===== Config =====
_G.Config = _G.Config or {}

-- Pickaxes à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸²à¸¡
_G.Config.targetPickaxes = _G.Config.targetPickaxes or {
    "Arcane Pickaxe",
    "Magma Pickaxe",
    "Demonic Pickaxe",
    "Prismatic Pickaxe"
}

-- à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚à¸à¸²à¸£à¹€à¸ªà¸£à¹‡à¸ˆ
_G.Config.completionPickaxe = _G.Config.completionPickaxe or "Demonic Pickaxe"  -- Pickaxe à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£ + à¹€à¸‡à¸´à¸™
_G.Config.completionGold = _G.Config.completionGold or 500000                    -- à¹€à¸‡à¸´à¸™à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢
_G.Config.priorityPickaxe = _G.Config.priorityPickaxe or "Prismatic Pickaxe"    -- Pickaxe à¸—à¸µà¹ˆà¹„à¸”à¹‰à¹à¸¥à¹‰à¸§ DONE à¸—à¸±à¸™à¸—à¸µ

-- à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹€à¸§à¸¥à¸²
_G.Config.checkDelay = _G.Config.checkDelay or 10  -- à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸—à¸¸à¸à¸à¸µà¹ˆà¸§à¸´à¸™à¸²à¸—à¸µ
_G.Config.doneDelay = _G.Config.doneDelay or 5     -- à¸£à¸­à¸à¸µà¹ˆà¸§à¸´à¸™à¸²à¸—à¸µà¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡ DONE

-- ===== Wait Game + Horst =====
repeat task.wait(5) until game:IsLoaded()
repeat task.wait(.1) until _G.Horst_SetDescription and _G.Horst_AccountChangeDone

-- ===== Services =====
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local plr = Players.LocalPlayer

local Shared = ReplicatedStorage:WaitForChild("Shared")
local Equipments = require(ReplicatedStorage.Shared.Data.Equipments)

local Knit = require(Shared.Packages.Knit)
local PlayerController = Knit.GetController("PlayerController")
local Replica = PlayerController.Replica

-- ===== Wait for Data =====
print("â³ Waiting for Replica.Data...")
repeat task.wait(0.5) until Replica.Data and Replica.Data.Inventory and Replica.Data.Inventory.Equipments
print("âœ… Replica.Data loaded!")

-- ===== Helper Functions =====
local function hasPickaxe(pickaxeName, inventory)
    if not inventory then return false end
    for _, item in pairs(inventory) do
        if typeof(item) == "table" and item.Name == pickaxeName then
            return true
        end
    end
    return false
end

local function getRaceEmoji(race)
    local raceEmojis = {
        ["Demon"] = "ğŸ‘¿", ["Angel"] = "ğŸ‘¼ğŸ»", ["Archangel"] = "ğŸ‘¼ğŸ»ğŸ‘¿",
        ["Shadow"] = "ğŸŒ‘", ["Developer"] = "ğŸ’»", ["Golem"] = "ğŸ—¿",
        ["Orc"] = "ğŸŸ¢", ["Minotaur"] = "ğŸ‚", ["Dragonborn"] = "ğŸ‰",
        ["Dwarf"] = "â›ï¸", ["Zombie"] = "ğŸ§Ÿ", ["Orc Lord"] = "ğŸ‘‘ğŸŸ¢",
        ["Undead"] = "ğŸ’€", ["Human"] = "ğŸ‘¤", ["Elf"] = "ğŸ§", ["Goblin"] = "ğŸ‘º"
    }
    return raceEmojis[race] or "â“"
end

local function getPickaxeShort(pickaxeName)
    local shortcuts = {
        ["Arcane Pickaxe"] = "AC",
        ["Magma Pickaxe"] = "MM",
        ["Demonic Pickaxe"] = "DM",
        ["Prismatic Pickaxe"] = "PRI",
        ["Diamond Pickaxe"] = "DIA",
        ["Legendary Pickaxe"] = "LEG"
    }
    return shortcuts[pickaxeName] or pickaxeName:sub(1, 3):upper()
end

local function formatNumber(num)
    num = math.floor(num)
    if num >= 1000000 then
        return string.format("%.1fM", num / 1000000):gsub("%.0M", "M")
    elseif num >= 1000 then
        return string.format("%.1fk", num / 1000):gsub("%.0k", "k")
    else
        return tostring(num)
    end
end

-- ===== Main Loop =====
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("â›ï¸ Pickaxe Tracker Starting...")
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("ğŸ¯ Config:")
print("  â€¢ Priority Pickaxe: " .. _G.Config.priorityPickaxe)
print("  â€¢ Target Pickaxe: " .. _G.Config.completionPickaxe)
print("  â€¢ Target Gold: " .. formatNumber(_G.Config.completionGold))
print("  â€¢ Check Delay: " .. _G.Config.checkDelay .. "s")
print("  â€¢ Tracking: " .. table.concat(_G.Config.targetPickaxes, ", "))
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")

while true do
    task.wait(_G.Config.checkDelay)
    
    pcall(function()
        if not Replica.Data or not Replica.Data.Inventory then return end
        
        local Gold = Replica.Data.Gold or 0
        local Race = Replica.Data.Race or "None"
        local Level = Replica.Data.Level or 0
        local inventory = Replica.Data.Inventory.Equipments
        
        hasDemonic = false
        hasPrismatic = false
        local pickaxeStatus = {}
        
        for _, targetName in ipairs(_G.Config.targetPickaxes) do
            local found = hasPickaxe(targetName, inventory)
            local shortName = getPickaxeShort(targetName)
            table.insert(pickaxeStatus, (found and "âœ…" or "âŒ") .. shortName)
            
            if found and targetName == _G.Config.completionPickaxe then
                hasDemonic = true
            end
            
            if found and targetName == _G.Config.priorityPickaxe then
                hasPrismatic = true
            end
        end
        
        -- Build message
        local message = string.format(
            "%s%s , ğŸ“ŠLv.%d , ğŸ’°%s , %s",
            getRaceEmoji(Race),
            Race,
            Level,
            formatNumber(Gold),
            table.concat(pickaxeStatus, " ")
        )
        
        -- Build JSON
        local jsonData = string.format(
            '{"RACE":"%s","Level":%d,"Gold":"%s","ArcanePickaxe":"%s","MagmaPickaxe":"%s","DemonicPickaxe":"%s","PrismaticPickaxe":"%s"}',
            Race,
            Level,
            formatNumber(Gold),
            hasPickaxe("Arcane Pickaxe", inventory) and "âœ…" or "âŒ",
            hasPickaxe("Magma Pickaxe", inventory) and "âœ…" or "âŒ",
            hasPickaxe("Demonic Pickaxe", inventory) and "âœ…" or "âŒ",
            hasPickaxe("Prismatic Pickaxe", inventory) and "âœ…" or "âŒ"
        )
        
        print("ğŸ“¤", message)
        
        pcall(function()
            _G.Horst_SetDescription(message, jsonData)
        end)
        
        -- à¹€à¸Šà¹‡à¸„ Priority Pickaxe
        if hasPrismatic then
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("ğŸŒŸ à¸à¸š " .. _G.Config.priorityPickaxe .. "!")
            print("ğŸ¯ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸ªà¸³à¹€à¸£à¹‡à¸ˆ! (Priority)")
            print("â³ à¸£à¸­ " .. _G.Config.doneDelay .. " à¸§à¸´à¸™à¸²à¸—à¸µ à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡ DONE...")
            task.wait(_G.Config.doneDelay)
            
            pcall(function()
                _G.Horst_SetDescription(message, jsonData)
            end)
            task.wait(1)
            
            pcall(_G.Horst_AccountChangeDone)
            return true
        end
        
        -- à¹€à¸Šà¹‡à¸„à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚ Completion
        if hasDemonic and Gold >= _G.Config.completionGold then
            print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
            print("ğŸ¯ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!")
            print("  âœ… à¸¡à¸µ " .. _G.Config.completionPickaxe)
            print("  âœ… à¹€à¸‡à¸´à¸™ " .. formatNumber(Gold) .. " / " .. formatNumber(_G.Config.completionGold))
            print("â³ à¸£à¸­ " .. _G.Config.doneDelay .. " à¸§à¸´à¸™à¸²à¸—à¸µ à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡ DONE...")
            task.wait(_G.Config.doneDelay)
            
            pcall(function()
                _G.Horst_SetDescription(message, jsonData)
            end)
            task.wait(1)
            
            pcall(_G.Horst_AccountChangeDone)
            return true
        end
    end)
    
    if hasPrismatic then break end
    if hasDemonic and (Replica.Data.Gold or 0) >= _G.Config.completionGold then break end
end

print("ğŸ Script Finished!")
